<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Glasses Inventory</title>
    <script>
        async function fetchGlasses() {
            const response = await fetch("https://script.google.com/macros/s/AKfycbxIuaCCN9qkDxxMO8uBrIwkP-8NNo378zTcns1kiNSf6uZKchBkOpGDK6d-6qQ9p_BkSg/exec");
            const data = await response.json();
            
            let table = `<table border="1">
                <tr>
                    <th>Frame Color</th>
                    <th>Lens Type</th>
                    <th>Right Sphere</th>
                    <th>Left Sphere</th>
                    <th>Image</th>
                    <th>Request</th>
                </tr>`;
            
            data.forEach(item => {
                table += `<tr>
                    <td>${item["Frame Color"]}</td>
                    <td>${item["Lens Type"]}</td>
                    <td>${item["Right Lens Sphere"]}</td>
                    <td>${item["Left Lens Sphere"]}</td>
                    <td><img src="${item["Image"]}" width="100"></td>
                    <td><button onclick="requestGlasses('${item["Frame Color"]}', '${item["Lens Type"]}')">Request</button></td>
                </tr>`;
            });

            table += `</table>`;
            document.getElementById("inventory").innerHTML = table;
        }

        function requestGlasses(frameColor, lensType) {
            const formLink = "https://docs.google.com/forms/d/e/1FAIpQLSdFZfahyG5OG08Ph1Gfm7IKjl69yqc6uXfrrz7vFsTfAUwFFQ/viewform?usp=sharing";  
            window.open(`${formLink}?entry.123456=${frameColor}&entry.654321=${lensType}`, "_blank");
        }

        window.onload = fetchGlasses;
    </script>
</head>
<body>
    <h1>Glasses Inventory</h1>
    <div id="inventory">Loading...</div>
</body>
</html>

